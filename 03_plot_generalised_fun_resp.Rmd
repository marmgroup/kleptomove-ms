---
output: html_document
editor_options: 
  chunk_output_type: console
---

# Function Response of Intake to All Predators

```{r}
library(data.table)
library(ggplot2)
library(pals)

# custom functions
source("code/functional_response.R")
```


## Get data

```{r}
# read general fun response and split by sim type
data <- fread("data/results/data_funresp_vdmens.csv")

# get specific regrowths
data <- data[regrowth %in% c(0.001, 0.01, 0.05, 0.1, 0.25), ]
```

```{r}
# split by sim type
data <- split(data, by = "sim_type")
```

```{r}
# check plot
ggplot(data[[1]])+
  geom_point(aes(
    total_agents,
    meanv,
    col = variable
  ),
  # size = 0.2,
  alpha = 0.2)+
  facet_grid(~ regrowth)+
  # scale_x_sqrt()+
  coord_cartesian(xlim = c(0, 0.5),
                  ylim = c(0, 0.5))+
  scale_colour_discrete_diverging()
```



```{r}
fig_fun_response <-
  lapply(data, function(df) {
    ggplot(df)+
      geom_point(aes(
        total_agents,
        meanv,
        group = interaction(replicate, gen, variable),
        col = variable
      ),
      size = 0.2,
      alpha = 0.2)+
      facet_grid(~ regrowth)+
      # scale_x_sqrt()+
      coord_cartesian(xlim = c(0, 0.5),
                      ylim = c(0, 0.25))+
      scale_colour_discrete_diverging()+
      labs(
        fill = "per-captia\nintake",
        x = "# food items",
        y = "# individuals"
      )
  })

fig_fun_response <- patchwork::wrap_plots(fig_fun_response[c(
  "foragers",
  "obligate",
  "facultative"
)],
ncol = 1,
guides = "collect"
) &
  theme(legend.position = "top")
fig_fun_response
# fig_fun_response[[3]]
```

```{r}
ggsave(fig_fun_response,
  filename = "figures/fig_fun_response_general.png",
  dpi = 150
)
```
